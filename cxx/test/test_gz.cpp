
#if __has_include(<zlib.h>)
#include <doctest/doctest.h>
#include <fstream>
#include "../graphidx/io/path.hpp"
#include "../graphidx/io/gzistream.hpp"


const unsigned char msg_gz[] = {
    0x1F, 0x8B, 0x08, 0x08, 0x36, 0xBF, 0x68, 0x5E,
    0x00, 0x03, 0x6D, 0x73, 0x67, 0x2E, 0x74, 0x78,
    0x74, 0x00, 0xCB, 0x48, 0xCD, 0xC9, 0xC9, 0x57,
    0x48, 0x2F, 0x4A, 0x2C, 0xC8, 0xC8, 0x4C, 0xA9,
    0xE0, 0x02, 0x00, 0xCC, 0x85, 0x6F, 0x30, 0x0F,
    0x00, 0x00, 0x00,
};



constexpr char msg_txt[] = "hello graphidx\n";


TEST_CASE("gzistream: small msg")
{
    WriteFile f0 ("msg.gz", (const char *) msg_gz, sizeof(msg_gz));
    GZIStream io ("msg.gz");
    CHECK(read_string(io, sizeof(msg_txt)) == msg_txt);
}


#endif
